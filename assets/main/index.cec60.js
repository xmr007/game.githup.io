window.__require=function e(t,o,n){function i(a,s){if(!o[a]){if(!t[a]){var r=a.split("/");if(r=r[r.length-1],!t[r]){var d="function"==typeof __require&&__require;if(!s&&d)return d(r,!0);if(c)return c(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var h=o[a]={exports:{}};t[a][0].call(h.exports,function(e){return i(t[a][1][e]||e)},h,h.exports,e,t,o,n)}return o[a].exports}for(var c="function"==typeof __require&&__require,a=0;a<n.length;a++)i(n[a]);return i}({common:[function(e,t,o){"use strict";cc._RF.push(t,"7f8debWqvJO27svgzItR9Yj","common");var n=t.exports;n.__esModule=!0,n.SCORE_KEY=n.kNotNeed=n.kNeed=n.GUIDE_KEY=n.kSoundOff=n.kSoundOn=n.SOUND_KEY=n.kTotalLeafCount=n.ScoreDeltaType=n.PandaStatus=n.PandaDirection=n.kSideCount=n.kPropNumber=n.PropType=n.kBambooNumber=n.InsectType=n.SideType=n.BambooType=n.kTouchMoveThreshold=n.GameStatus=void 0,n.kTouchMoveThreshold=10,n.GameStatus={RUN:0,OVER:1,PAUSE:2},n.InsectType={LAYDYBUG:0,FIREFLY:1,WORM:2},n.BambooType={LEFT_BAMBOO:0,MIDDLE_BAMBOO:1,RIGHT_BAMBOO:2},n.kBambooNumber=3,n.PropType={SHIELD:0,SHAKE:1,LIFE:2},n.kPropNumber=3,n.SideType={LEFT_SIDE:0,RIGHT_SIDE:1},n.kSideCount=2,n.PandaDirection={IDLE:0,UP:1,DOWN:2,LEFT:3,RIGHT:4},n.PandaStatus={NORMAL:0,GOD:1},n.ScoreDeltaType={LOW:20,MEDIUM:50,LARGE:70},n.kTotalLeafCount=10,n.SOUND_KEY="sound_on",n.kSoundOn="on",n.kSoundOff="off",n.GUIDE_KEY="need_guide",n.kNeed="y",n.kNotNeed="n",n.SCORE_KEY="highest_score",cc._RF.pop()},{}],game:[function(e,t,o){"use strict";cc._RF.push(t,"f3cc7T4rFFBH60MCpNrgA3l","game");var n=e;t.exports;function i(e,t){var o;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(o=c(e))||t&&e&&"number"==typeof e.length){o&&(e=o);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(o=e[Symbol.iterator]()).next.bind(o)}function c(e,t){if(e){if("string"==typeof e)return a(e,t);var o=Object.prototype.toString.call(e).slice(8,-1);return"Object"===o&&e.constructor&&(o=e.constructor.name),"Map"===o||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,n=new Array(t);o<t;o++)n[o]=e[o];return n}var s=n("common"),r=function(e){return e&&e.__esModule?e:{default:e}}(n("toast")),d=n("global");cc.Class({extends:cc.Component,properties:{background_music:{type:cc.AudioClip,default:null},leaf_bite_effect:cc.AudioClip,speedup_effect:cc.AudioClip,game_bonus_effect:cc.AudioClip,game_over_effect:cc.AudioClip,background_layer:{type:cc.Sprite,default:null},panda:{type:cc.Sprite,default:null},leaf:cc.Sprite,leaf_count_label:cc.Label,score_label:cc.Label,shield_prefab:cc.Prefab,shake_prefab:cc.Prefab,life_prefab:cc.Prefab,pop_score_prefab:cc.Prefab,reduce_leaf_prefab:cc.Prefab,add_leaf_prefab:cc.Prefab,prop_bonus_score:200,speedup_score:1e3,speed_boost_ratio:.5,ladybug_prefab:cc.Prefab,firefly_prefab:cc.Prefab,worm_prefab:cc.Prefab,insect_generate_interval:2,speedup_label:cc.Sprite,eatout_label:cc.Sprite,game_mask:cc.Sprite,game_over_panel:cc.Sprite,game_revive_button:cc.Button,home_button:cc.Button,replay_button:cc.Button,total_score_label:cc.Label,help_button:cc.Button,help_panel:cc.Sprite,help_panel_close_button:cc.Button,pause_resume_button:cc.Button,pause_texture:cc.SpriteFrame,resume_texture:cc.SpriteFrame,pause_text:cc.Label,prestart_text:cc.Label,tip_text:cc.Label,gesture_layer:cc.Node,click_effect:cc.AudioClip},onLoad:function(){var e=this;cc.director.preloadScene("start");var t=cc.sys.localStorage.getItem(s.SOUND_KEY);null===t?(cc.log("sound_on not saved before"),this.sound_on=s.kSoundOn,cc.sys.localStorage.setItem(s.SOUND_KEY,this.sound_on)):(cc.log("sound_on read from saved data:",t),this.sound_on=t);var o=cc.sys.localStorage.getItem(s.GUIDE_KEY);if(null===o||""===o?(cc.log("need guide not saved before"),this.need_guide=s.kNeed,cc.sys.localStorage.setItem(s.GUIDE_KEY,this.need_guide)):(cc.log("need guide read from saved data:",o),this.need_guide=o),cc.sys.platform===cc.sys.WECHAT_GAME){this.wechat_pause_ad=null,wx.createInterstitialAd&&(this.wechat_pause_ad=wx.createInterstitialAd({adUnitId:"adunit-f976850e525c452b"}),console.log("wechat_pause_ad created")),this.wechat_panda_revive_ad=null,this.wechat_panda_revive_ad=wx.createRewardedVideoAd({adUnitId:"adunit-28ef8a754508c783"}),this.wechat_panda_revive_ad.onError(function(e){console.err("panda_revive_ad create error:",e)}),console.log("panda_revive_ad created"),this.wechat_panda_revive_ad.onClose(function(t){t&&t.isEnded||void 0===t?(console.log("panda_revive_ad success"),(0,r.default)("\u89c6\u9891\u89c2\u770b\u5b8c\u6210\uff0c\u606d\u559c\u590d\u6d3b\uff01"),e.gameRevive()):(console.log("panda_revive_ad quit"),(0,r.default)("\u89c6\u9891\u89c2\u770b\u672a\u5b8c\u6210\uff0c\u672a\u590d\u6d3b")),e.sound_on===s.kSoundOn&&(cc.audioEngine.pauseMusic(),cc.audioEngine.resumeMusic())});var n=wx.getSystemInfoSync();this.wechat_banner_ad=wx.createBannerAd({adUnitId:"adunit-928f1bcc26492515",style:{left:n.screenWidth/2,top:n.screenHeight-90,width:300}}),this.wechat_banner_ad.onResize(function(){e.wechat_banner_ad.style.left=n.screenWidth/2-150+.1,e.wechat_banner_ad.style.top=n.screenHeight-e.wechat_banner_ad.style.realHeight+.1}),this.wechat_banner_ad.onLoad(function(){console.log("wechat banner id load success")}),this.wechat_banner_ad.onError(function(e){console.error("wechat banner id load error: ",e)})}else cc.sys.platform,cc.sys.BYTEDANCE_GAME},start:function(){var e=this;cc.log("=== game start ==="),this.game_mask.node.opacity=0,this.game_mask.node.active=!1,this.game_revive_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),cc.sys.platform===cc.sys.WECHAT_GAME?e.wechat_panda_revive_ad&&e.wechat_panda_revive_ad.show().catch(function(){e.wechat_panda_revive_ad.load().then(function(){return videoAd.show()}).catch(function(e){console.err("play wechat panda revive video ad failed")})}):cc.sys.platform===cc.sys.BYTEDANCE_GAME?(0,r.default)("\u5f53\u524d\u5e73\u53f0\u6682\u4e0d\u652f\u6301"):e.gameRevive()}),this.home_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),cc.director.loadScene("start")}),this.replay_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),cc.director.loadScene("game")}),this.help_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),e.game_status!==s.GameStatus.OVER&&(e.help_panel.node.active?e.hideHelp():e.showHelp())}),this.help_panel_close_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),e.hideHelp()}),this.pause_resume_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),e.game_status===s.GameStatus.RUN?(cc.director.pause(),e.game_status=s.GameStatus.PAUSE,e.pause_resume_button.getComponent(cc.Sprite).spriteFrame=e.resume_texture,e.pause_text.node.active=!0,cc.sys.platform===cc.sys.WECHAT_GAME&&(e.wechat_pause_ad?e.wechat_pause_ad.show().catch(function(e){console.error("show wechat pause ad err:",e)}):console.error("wechat_pause_ad is null"))):e.game_status===s.GameStatus.PAUSE&&(cc.director.resume(),e.game_status=s.GameStatus.RUN,e.pause_resume_button.getComponent(cc.Sprite).spriteFrame=e.pause_texture,e.pause_text.node.active=!1)}),this.sound_on===s.kSoundOn&&cc.audioEngine.play(this.background_music,!0,1),this.game_status=s.GameStatus.RUN,this.score=0,this.bonus_score_level=this.prop_bonus_score,this.speedup_score_level=this.speedup_score,this.leaf_count=s.kTotalLeafCount,this.speed_factor=1,this.touch_start_point=cc.Vec2(0,0),this.props=new Set,this.left_insects=new Set,this.middle_insects=new Set,this.right_insects=new Set,this.addEventHandle(),this.schedule(function(){this.generateInsect()},this.insect_generate_interval),this.need_guide===s.kNeed&&this.scheduleOnce(function(){this.splashGesture(),this.need_guide=s.kNotNeed,cc.sys.localStorage.setItem(s.GUIDE_KEY,this.need_guide)},7);var t=cc.repeat(cc.sequence(cc.fadeIn(.5),cc.delayTime(.5),cc.fadeOut(.5)),5);this.tip_text.node.runAction(t),cc.sys.platform===cc.sys.WECHAT_GAME&&(this.wechat_banner_ad.hide(),this.preStartGame())},onDestroy:function(){cc.sys.platform===cc.sys.WECHAT_GAME&&this.wechat_banner_ad&&this.wechat_banner_ad.destroy()},preStartGame:function(){this.prestart_text.node.active=!0;var e=3;this.prestart_text.string=e,this.schedule(function(){e-=1,this.prestart_text.string=e,0===e&&(this.prestart_text.node.active=!1)},1,3,0)},splashGesture:function(){this.game_mask.node.active=!0;var e=cc.fadeTo(.3,150);this.game_mask.node.runAction(e),this.gesture_layer.active=!0,this.scheduleOnce(function(){this.game_mask.node.opacity=0,this.game_mask.node.active=!1,this.gesture_layer.active=!1},4)},showHelp:function(){this.game_mask.node.active=!0;var e=cc.fadeTo(.3,150);this.game_mask.node.runAction(e),this.help_panel.node.active=!0,this.help_panel.node.setScale(.8);var t=cc.scaleTo(.15,1).easing(cc.easeCubicActionInOut()),o=cc.callFunc(function(){cc.director.pause()},this);this.help_panel.node.runAction(cc.sequence(t,o)),this.game_status=s.GameStatus.PAUSE,this.pause_resume_button.getComponent(cc.Sprite).spriteFrame=this.resume_texture},hideHelp:function(){this.game_status!==s.GameStatus.OVER&&(this.game_mask.node.opacity=0,this.game_mask.node.active=!1),this.help_panel.node.active=!1,cc.director.resume(),this.game_status=s.GameStatus.RUN,this.pause_resume_button.getComponent(cc.Sprite).spriteFrame=this.pause_texture},addEventHandle:function(){var e=this;this.node.on("touchstart",function(t){e.onTouchStart(t)}),this.node.on("touchmove",function(t){e.onTouchMove(t)}),this.node.on("touchend",function(t){e.onTouchEnd(t)}),this.node.on("touchcancel",function(t){e.onTouchEnd(t)})},onTouchStart:function(e){this.game_status===s.GameStatus.RUN&&(this.touch_start_point=e.getLocation(),this.touch_pre_center_point=e.getLocation())},onTouchMove:function(e){if(this.game_status===s.GameStatus.RUN){var t=e.getLocation(),o=t.x-this.touch_pre_center_point.x,n=t.y-this.touch_pre_center_point.y;Math.abs(n)>s.kTouchMoveThreshold&&Math.abs(n)>Math.abs(o)&&(n>0?(this.touch_pre_center_point=cc.v2(t.x,t.y-s.kTouchMoveThreshold),this.panda.getComponent("panda").moveUp()):n<0&&(this.touch_pre_center_point=cc.v2(t.x,t.y+s.kTouchMoveThreshold),this.panda.getComponent("panda").moveDown()))}},onTouchEnd:function(e){if(this.game_status===s.GameStatus.RUN){var t=e.getLocation(),o=t.x-this.touch_start_point.x,n=t.y-this.touch_start_point.y;Math.abs(o)>s.kTouchMoveThreshold&&Math.abs(o)>Math.abs(n)&&(o>0?this.panda.getComponent("panda").jumpRight():o<0&&this.panda.getComponent("panda").jumpLeft()),this.panda.getComponent("panda").idle()}},generateProp:function(){cc.log("--- generate new prop"),cc.audioEngine.playEffect(this.game_bonus_effect),this.left_bamboo=this.background_layer.node.getChildByName("left_bamboo"),this.middle_bamboo=this.background_layer.node.getChildByName("middle_bamboo"),this.right_bamboo=this.background_layer.node.getChildByName("right_bamboo");var e=Math.floor(Math.random()*s.kPropNumber),t=null;if(e===s.PropType.SHIELD){if(this.panda.getComponent("panda").panda_status===s.PandaStatus.GOD)return cc.log("### skip this type and generate prop again"),void this.generateProp();t=cc.instantiate(this.shield_prefab)}else e===s.PropType.SHAKE?t=cc.instantiate(this.shake_prefab):e===s.PropType.LIFE?t=cc.instantiate(this.life_prefab):cc.log("unkown prop type");var o=Math.floor(Math.random()*s.kBambooNumber),n=null,i=null;o===s.BambooType.LEFT_BAMBOO?(n=this.left_bamboo.position,i=this.left_bamboo.getContentSize()):o===s.BambooType.MIDDLE_BAMBOO?(n=this.middle_bamboo.position,i=this.middle_bamboo.getContentSize()):o===s.BambooType.RIGHT_BAMBOO?(n=this.right_bamboo.position,i=this.right_bamboo.getContentSize()):cc.log("unkown bamboo id");var c=Math.floor(Math.random()*s.kSideCount);if(c===s.SideType.LEFT_SIDE){var a=n.x-i.width/2-t.width/2,r=7*-t.height+Math.random()*t.height*14;t.setPosition(cc.v2(a,r))}else if(c===s.SideType.RIGHT_SIDE){var d=n.x+i.width/2+t.width/2,h=7*-t.height+Math.random()*t.height*14;t.setPosition(d,h)}t.getComponent("prop").setType(e),this.props.add(t),this.background_layer.node.addChild(t)},generateInsect:function(){cc.log("--- generate new insect"),this.left_bamboo=this.background_layer.node.getChildByName("left_bamboo"),this.middle_bamboo=this.background_layer.node.getChildByName("middle_bamboo"),this.right_bamboo=this.background_layer.node.getChildByName("right_bamboo");var e=Math.floor(Math.random()*Object.keys(s.InsectType).length);cc.log("new insect:",e);var t=null;e===s.InsectType.LAYDYBUG?t=cc.instantiate(this.ladybug_prefab):e===s.InsectType.FIREFLY?t=cc.instantiate(this.firefly_prefab):e===s.InsectType.WORM?t=cc.instantiate(this.worm_prefab):cc.log("unkown insect type");var o=Math.floor(Math.random()*s.kBambooNumber);cc.log("bamboo_id:",o);var n=null,i=null;o===s.BambooType.LEFT_BAMBOO?(n=this.left_bamboo.position,i=this.left_bamboo.getContentSize(),this.left_insects.add(t)):o===s.BambooType.MIDDLE_BAMBOO?(n=this.middle_bamboo.position,i=this.middle_bamboo.getContentSize(),this.middle_insects.add(t)):o===s.BambooType.RIGHT_BAMBOO?(n=this.right_bamboo.position,i=this.right_bamboo.getContentSize(),this.right_insects.add(t)):cc.log("unkown bamboo id");var c=Math.floor(Math.random()*s.kSideCount);if(cc.log("side:",c),c===s.SideType.LEFT_SIDE){var a=n.x-i.width/2-t.width/2+10,r=-i.height/2-t.height/2;t.setPosition(cc.v2(a,r))}else if(c===s.SideType.RIGHT_SIDE){var d=n.x+i.width/2+t.width/2-10,h=-i.height/2-t.height/2;t.setPosition(d,h),t.scaleX=-1}t.getComponent("insect").setTypeAndSide(e,c),t.getComponent("insect").setMoveSpeed(this.speed_factor),this.background_layer.node.addChild(t)},increaseScore:function(e){var t=0;e===s.InsectType.WORM?t=s.ScoreDeltaType.LOW:e===s.InsectType.LAYDYBUG?t=s.ScoreDeltaType.MEDIUM:e===s.InsectType.FIREFLY&&(t=s.ScoreDeltaType.LARGE);var o=this.score;this.score+=t,this.schedule(function(){o+=1,this.score_label.string=o},.01,t-1,0),this.total_score_label.string=this.score,d.gCurrentScore=this.score;var n=cc.instantiate(this.pop_score_prefab);this.background_layer.node.addChild(n),n.getComponent(cc.Label).string="+"+t,n.setPosition(this.panda.node.x,this.panda.node.y+this.panda.node.height/2);var i=cc.moveBy(.2,0,n.height/2),c=cc.fadeOut(.2),a=cc.callFunc(function(){n.removeFromParent()},this),r=cc.sequence(i,c,a);n.runAction(r),this.score>=this.bonus_score_level&&(this.generateProp(),this.bonus_score_level+=this.prop_bonus_score),this.score>=this.speedup_score_level&&(this.speedUp(),this.speedup_score_level+=this.speedup_score)},increaseLeaf:function(){this.leaf_count+=1,this.leaf_count_label.string="x "+this.leaf_count,4===this.leaf_count&&(this.leaf_count_label.node.color=new cc.Color(225,255,255));var e=cc.sequence(cc.scaleTo(.3,1.5),cc.scaleTo(.3,1));this.leaf.node.runAction(cc.repeat(e,2));var t=cc.instantiate(this.add_leaf_prefab);this.background_layer.node.addChild(t),t.setPosition(this.panda.node.x,this.panda.node.y+this.panda.node.height/2);var o=cc.moveBy(.3,0,t.height/2),n=cc.fadeOut(.5),i=cc.callFunc(function(){t.removeFromParent()},this),c=cc.sequence(o,n,i);t.runAction(c)},decreaseLeaf:function(){cc.audioEngine.playEffect(this.leaf_bite_effect),this.leaf_count-=1,this.leaf_count_label.string="x "+this.leaf_count,3===this.leaf_count&&(this.leaf_count_label.node.color=new cc.Color(225,0,0));var e=cc.sequence(cc.rotateTo(.3,25),cc.rotateTo(.3,0));this.leaf.node.runAction(cc.repeat(e,2));var t=cc.instantiate(this.reduce_leaf_prefab);this.background_layer.node.addChild(t),t.setPosition(this.panda.node.x,this.panda.node.y+this.panda.node.height/2);var o=cc.moveBy(.3,0,t.height/2),n=cc.fadeOut(.5),i=cc.callFunc(function(){t.removeFromParent()},this),c=cc.sequence(o,n,i);t.runAction(c),this.leaf_count<=0&&(this.eatout_label.node.active=!0,this.eatout_label.node.opacity=0,this.eatout_label.node.runAction(cc.fadeIn(.7)),this.scheduleOnce(function(){this.eatout_label.node.opacity=0,this.eatout_label.node.active=!1},2),this.panda.getComponent("panda").drop(),this.gameOver())},speedUp:function(){cc.log("--- speed up ---"),cc.audioEngine.playEffect(this.speedup_effect),this.speedup_label.node.active=!0,this.speedup_label.node.setPosition(530,380);var e=cc.moveTo(.6,0,380).easing(cc.easeCubicActionInOut()),t=cc.delayTime(1),o=cc.moveBy(.5,0,this.background_layer.node.height/2-380+this.speedup_label.node.height).easing(cc.easeCubicActionInOut()),n=cc.callFunc(function(){this.speedup_label.node.active=!1},this),i=cc.sequence(e,t,o,n);this.speedup_label.node.runAction(i),this.speed_factor*=1+this.speed_boost_ratio},dropAllInsects:function(){for(var e,t,o,n=i(this.left_insects);!(e=n()).done;){var c=e.value;this.left_insects.delete(c),this.increaseScore(c.getComponent("insect").insect_type),c.getComponent("insect").drop()}for(var a=i(this.middle_insects);!(t=a()).done;){var s=t.value;this.middle_insects.delete(s),this.increaseScore(s.getComponent("insect").insect_type),s.getComponent("insect").drop()}for(var r=i(this.right_insects);!(o=r()).done;){var d=o.value;this.right_insects.delete(d),this.increaseScore(d.getComponent("insect").insect_type),d.getComponent("insect").drop()}},clearAllInsects:function(){for(var e,t,o,n=i(this.left_insects);!(e=n()).done;){var c=e.value;this.left_insects.delete(c),c.removeFromParent()}for(var a=i(this.middle_insects);!(t=a()).done;){var s=t.value;this.middle_insects.delete(s),s.removeFromParent()}for(var r=i(this.right_insects);!(o=r()).done;){var d=o.value;this.right_insects.delete(d),d.removeFromParent()}},shakeEffect:function(e){cc.callFunc(function(){this.background_layer.node.setPosition(0,0)},this);var t=cc.v2(0,10);this.background_layer.node.runAction(cc.repeat(cc.sequence(cc.moveTo(.02,t.rotate(Math.PI/4*0%8)),cc.moveTo(.02,t.rotate(Math.PI/4*3%8)),cc.moveTo(.02,t.rotate(Math.PI/4*6%8)),cc.moveTo(.02,t.rotate(Math.PI/4*9%8)),cc.moveTo(.02,t.rotate(Math.PI/4*12%8)),cc.moveTo(.02,t.rotate(Math.PI/4*15%8)),cc.moveTo(.02,t.rotate(Math.PI/4*18%8)),cc.moveTo(.02,t.rotate(Math.PI/4*21%8))),3))},update:function(e){if(this.game_status===s.GameStatus.RUN){for(var t,o,n,c,a=this.panda.getComponent("panda").panda_status,r=this.panda.node.getBoundingBox(),d=this.panda.getComponent("panda").current_bamboo_id,h=this.panda.getComponent("panda").direction,l=i(this.props);!(t=l()).done;){var u=t.value;r.intersects(u.getBoundingBox())&&(this.panda.getComponent("panda").fetchProp(u.getComponent("prop").prop_type),this.props.delete(u),u.removeFromParent())}if(h===s.PandaDirection.DOWN){if(d===s.BambooType.LEFT_BAMBOO)for(var _,p=i(this.left_insects);!(_=p()).done;){var m=_.value;r.intersects(m.getBoundingBox())&&(cc.log("panda drop left insect"),this.left_insects.delete(m),this.increaseScore(m.getComponent("insect").insect_type),m.getComponent("insect").drop())}else if(d===s.BambooType.MIDDLE_BAMBOO)for(var f,g=i(this.middle_insects);!(f=g()).done;){var b=f.value;r.intersects(b.getBoundingBox())&&(cc.log("panda drop middle insect"),this.middle_insects.delete(b),this.increaseScore(b.getComponent("insect").insect_type),b.getComponent("insect").drop())}else if(d===s.BambooType.RIGHT_BAMBOO)for(var v,y=i(this.right_insects);!(v=y()).done;){var S=v.value;r.intersects(S.getBoundingBox())&&(cc.log("panda drop right insect"),this.right_insects.delete(S),this.increaseScore(S.getComponent("insect").insect_type),S.getComponent("insect").drop())}}else if(d===s.BambooType.LEFT_BAMBOO)for(var E,T=i(this.left_insects);!(E=T()).done;){var C=E.value;if(r.intersects(C.getBoundingBox()))if(a===s.PandaStatus.GOD)this.left_insects.delete(C),this.increaseScore(C.getComponent("insect").insect_type),C.getComponent("insect").drop();else if(a===s.PandaStatus.NORMAL)return this.panda.getComponent("panda").drop(),void this.gameOver()}else if(d===s.BambooType.MIDDLE_BAMBOO)for(var A,k=i(this.middle_insects);!(A=k()).done;){var B=A.value;if(r.intersects(B.getBoundingBox()))if(a===s.PandaStatus.GOD)this.middle_insects.delete(B),this.increaseScore(B.getComponent("insect").insect_type),B.getComponent("insect").drop();else if(a===s.PandaStatus.NORMAL)return this.panda.getComponent("panda").drop(),void this.gameOver()}else if(d===s.BambooType.RIGHT_BAMBOO)for(var I,O=i(this.right_insects);!(I=O()).done;){var w=I.value;if(r.intersects(w.getBoundingBox()))if(a===s.PandaStatus.GOD)this.right_insects.delete(w),this.increaseScore(w.getComponent("insect").insect_type),w.getComponent("insect").drop();else if(a===s.PandaStatus.NORMAL)return this.panda.getComponent("panda").drop(),void this.gameOver()}this.left_bamboo=this.background_layer.node.getChildByName("left_bamboo"),this.middle_bamboo=this.background_layer.node.getChildByName("middle_bamboo"),this.right_bamboo=this.background_layer.node.getChildByName("right_bamboo");for(var M=i(this.left_insects);!(o=M()).done;){var D=o.value;D.y>=this.left_bamboo.height/2&&(this.decreaseLeaf(),this.left_insects.delete(D),D.removeFromParent())}for(var P=i(this.middle_insects);!(n=P()).done;){var x=n.value;x.y>=this.middle_bamboo.height/2&&(this.decreaseLeaf(),this.middle_insects.delete(x),x.removeFromParent())}for(var L=i(this.right_insects);!(c=L()).done;){var F=c.value;F.y>=this.right_bamboo.height/2&&(this.decreaseLeaf(),this.right_insects.delete(F),F.removeFromParent())}}},gameOver:function(){cc.log("=== game over ==="),cc.audioEngine.stopAll(),cc.audioEngine.playEffect(this.game_over_effect),this.game_status=s.GameStatus.OVER,cc.sys.platform===cc.sys.WECHAT_GAME&&this.wechat_banner_ad.show()},gameRevive:function(){this.clearAllInsects(),this.game_status=s.GameStatus.RUN,this.sound_on===s.kSoundOn&&cc.audioEngine.play(this.background_music,!0,1),this.game_mask.node.active=!1,this.game_over_panel.node.setPosition(this.game_over_panel_init_pos),this.game_mask.node.opacity=0,this.game_mask.node.active=!1,this.increaseLeaf(),this.panda.getComponent("panda").revive(),cc.sys.platform===cc.sys.WECHAT_GAME&&this.wechat_banner_ad.hide()},showGameOverPanel:function(){this.game_over_panel_init_pos=this.game_over_panel.node.position,this.game_mask.node.active=!0;var e=cc.fadeTo(.3,150);this.game_mask.node.runAction(e);var t=cc.moveTo(.7,cc.v2(0,0)).easing(cc.easeElasticOut());this.game_over_panel.node.runAction(t)}}),cc._RF.pop()},{}],global:[function(e,t,o){"use strict";cc._RF.push(t,"bc0c0eNpFBObalRSou9CFj/","global");var n=t;t.exports;n.exports={gCurrentScore:0},cc._RF.pop()},{}],insect:[function(e,t,o){"use strict";cc._RF.push(t,"f9c38uWQ7dBWrcoWDDEbHHT","insect");var n=e,i=(t.exports,n("common"));cc.Class({extends:cc.Component,properties:{kick_effect:cc.AudioClip,move_effect:cc.AudioClip,move_speed:100,drop_distance:30,drop_rotation:-60,drop_base_duration:1},start:function(){this.is_alive=!0,this.insect_type===i.InsectType.FIREFLY&&cc.audioEngine.playEffect(this.move_effect)},setTypeAndSide:function(e,t){this.insect_type=e,this.side=t},setMoveSpeed:function(e){this.move_speed*=e},drop:function(){this.is_alive=!1,cc.audioEngine.playEffect(this.kick_effect),cc.log("insect drop");var e=this.node.parent.getContentSize(),t=null;cc.log("the insect side:",this.side);var o=this.drop_base_duration;if(this.side===i.SideType.LEFT_SIDE){var n=this.node.x-this.drop_distance,c=-e.height/2-this.node.height/2;o=(this.node.y+e.height/2)/e.height*this.drop_base_duration,t=cc.spawn(cc.moveTo(o,cc.v2(n,c)),cc.rotateBy(o,this.drop_rotation))}else if(this.side===i.SideType.RIGHT_SIDE){var a=this.node.x+this.drop_distance,s=-e.height/2-this.node.height/2;o=(this.node.y+e.height/2)/e.height*this.drop_base_duration,t=cc.spawn(cc.moveTo(o,cc.v2(a,s)),cc.rotateBy(o,-this.drop_rotation))}if(t){var r=cc.callFunc(function(){this.node.active=!1,this.node.removeFromParent()},this),d=cc.sequence(t,r);this.node.runAction(d),this.scheduleOnce(function(){cc.log("### insect not removed normally, remove by timer"),this.node.removeFromParent()},o)}else cc.log("drop action is null"),this.node.active=!1,this.node.removeFromParent()},update:function(e){this.is_alive&&(this.node.y+=this.move_speed*e)}}),cc._RF.pop()},{}],menu:[function(e,t,o){"use strict";cc._RF.push(t,"74fbekP0MJAOKjUWqcDbvj6","menu");var n=e,i=(t.exports,n("common")),c=n("global"),a=n("toast");cc.Class({extends:cc.Component,properties:{panda_eye:cc.Sprite,record_label:cc.Label,start_button:{type:cc.Button,default:null},welcome_mask:cc.Sprite,rank_panel:cc.Node,rank_panel_close_button:cc.Button,rank_button:{type:cc.Button,default:null},share_button:{type:cc.Button,default:null},sound_button:{type:cc.Button,default:null},backgroundMusic:{type:cc.AudioClip,default:null},click_effect:cc.AudioClip,sound_on_texture:cc.SpriteFrame,sound_off_texture:cc.SpriteFrame},onLoad:function(){var e=this;cc.director.preloadScene("game");var t=cc.sys.localStorage.getItem(i.SOUND_KEY);null===t||""===t?(cc.log("sound_on not saved before"),this.sound_on=i.kSoundOn,cc.sys.localStorage.setItem(i.SOUND_KEY,this.sound_on)):(cc.log("sound_on read from saved data:",t),this.sound_on=t),this.record_score=0;var o=cc.sys.localStorage.getItem(i.SCORE_KEY);if(null===o||""===o?(cc.log("record score not saved yet"),this.record_score=0,cc.sys.localStorage.setItem(i.SCORE_KEY,this.record_score)):(cc.log("record score read from saved data:",o),this.record_score=o),c.gCurrentScore>this.record_score?(this.record_score=c.gCurrentScore,cc.sys.localStorage.setItem(i.SCORE_KEY,this.record_score)):c.gCurrentScore=this.record_score,this.rank_panel.active=!1,cc.sys.platform===cc.sys.WECHAT_GAME){if(wx.getOpenDataContext().postMessage({type:"player_score",data:c.gCurrentScore}),console.log("post player score to sub domain"),this.icon_ad=null,wx.createGameIcon){var n=wx.getSystemInfoSync();this.icon_ad=wx.createGameIcon({adUnitId:"PBgAAkggdeJgULzw",count:8,style:[]}),this.icon_ad.onResize(function(t){e.icon_ad.icons[0].appNameHidden=!0,e.icon_ad.icons[0].left=0,e.icon_ad.icons[0].top=n.screenHeight/2-60,e.icon_ad.icons[1].appNameHidden=!0,e.icon_ad.icons[1].left=0,e.icon_ad.icons[1].top=n.screenHeight/2,e.icon_ad.icons[2].appNameHidden=!0,e.icon_ad.icons[2].left=0,e.icon_ad.icons[2].top=n.screenHeight/2+60,e.icon_ad.icons[3].appNameHidden=!0,e.icon_ad.icons[3].left=0,e.icon_ad.icons[3].top=n.screenHeight/2+60+60,e.icon_ad.icons[4].appNameHidden=!0,e.icon_ad.icons[4].left=n.screenWidth-70,e.icon_ad.icons[4].top=n.screenHeight/2-60,e.icon_ad.icons[5].appNameHidden=!0,e.icon_ad.icons[5].left=n.screenWidth-70,e.icon_ad.icons[5].top=n.screenHeight/2,e.icon_ad.icons[6].appNameHidden=!0,e.icon_ad.icons[6].left=n.screenWidth-70,e.icon_ad.icons[6].top=n.screenHeight/2+60,e.icon_ad.icons[7].appNameHidden=!0,e.icon_ad.icons[7].left=n.screenWidth-70,e.icon_ad.icons[7].top=n.screenHeight/2+60+60})}this.icon_ad?this.icon_ad.load().then(function(){e.icon_ad.show()}).catch(function(e){console.error("load wechat icon ad failed, err:",e)}):console.error("wechat icon ad is null")}},start:function(){var e=this;this.welcome_mask.node.opacity=0,this.welcome_mask.node.active=!1,this.sound_on===i.kSoundOn?(this.sound_button.getComponent(cc.Sprite).spriteFrame=this.sound_on_texture,cc.audioEngine.play(this.backgroundMusic,!0,1)):this.sound_button.getComponent(cc.Sprite).spriteFrame=this.sound_off_texture,this.sound_button.node.on("click",function(){e.sound_on===i.kSoundOn?(e.sound_on=i.kSoundOff,e.sound_button.getComponent(cc.Sprite).spriteFrame=e.sound_off_texture,cc.audioEngine.stopAll()):(e.sound_on=i.kSoundOn,e.sound_button.getComponent(cc.Sprite).spriteFrame=e.sound_on_texture,cc.audioEngine.play(e.backgroundMusic,!0,1)),cc.sys.localStorage.setItem(i.SOUND_KEY,e.sound_on)},this),this.record_label.string=this.record_score;var t=cc.repeatForever(cc.sequence(cc.hide(),cc.delayTime(3),cc.show(),cc.delayTime(3)));this.panda_eye.node.runAction(t),this.rank_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),e.rank_panel.active?e.hideRank():e.showRank()}),this.rank_panel_close_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),e.hideRank()}),this.share_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),e.node.getComponent("share").doActiveShare()}),this.start_button.node.on("click",function(){cc.audioEngine.playEffect(e.click_effect),cc.audioEngine.stopAll(),e.node.runAction(cc.sequence(cc.fadeOut(.3),cc.callFunc(function(){cc.director.loadScene("game")})))},this)},getWxUserInfo:function(){if("undefined"!=typeof wx){var e=wx.createUserInfoButton({type:"text",text:"\u83b7\u53d6\u7528\u6237\u4fe1\u606f",style:{left:10,top:76,width:200,height:40,lineHeight:40,backgroundColor:"#ff0000",color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4}});e.onTap(function(t){a(t.userInfo?"\u6388\u6743\u6210\u529f\uff01":"\u6388\u6743\u5931\u8d25\uff01"),e.hide(),e.destroy()})}},onDestroy:function(){cc.sys.platform===cc.sys.WECHAT_GAME&&this.icon_ad&&this.icon_ad.destroy()},showRank:function(){if(cc.sys.platform===cc.sys.WECHAT_GAME){this.rank_panel.active=!0,this.welcome_mask.node.active=!0;var e=cc.fadeTo(.3,150);this.welcome_mask.node.runAction(e),this.rank_panel.setScale(.6);var t=cc.scaleTo(.15,1).easing(cc.easeCubicActionInOut());this.rank_panel.runAction(t),wx.getOpenDataContext().postMessage({type:"show_rank"}),console.log("send show rank signal to sub domain")}else cc.sys.platform===cc.sys.BYTEDANCE_GAME||a("\u5f53\u524d\u5e73\u53f0\u4e0d\u652f\u6301\u6392\u884c\u699c")},hideRank:function(){if(cc.sys.platform===cc.sys.WECHAT_GAME||cc.sys.platform===cc.sys.BYTEDANCE_GAME){this.welcome_mask.node.opacity=0,this.welcome_mask.node.active=!1;var e=cc.callFunc(function(){this.rank_panel.active=!1},this),t=cc.scaleTo(.15,.6).easing(cc.easeCubicActionInOut());this.rank_panel.runAction(cc.sequence(t,e))}}}),cc._RF.pop()},{}],panda:[function(e,t,o){"use strict";cc._RF.push(t,"b072c1AnSREY7rTlKJPvsib","panda");var n=e,i=(t.exports,n("common"));cc.Class({extends:cc.Component,properties:{game_canvas:cc.Node,jump_effect:cc.AudioClip,pick_effect:cc.AudioClip,all_kill_effect:cc.AudioClip,direction:i.PandaDirection.IDLE,move_speed:180,jump_duration:.15,jump_height:50,flip_duration:.1,drop_distance:30,drop_base_duration:1.5,leftside_texture:cc.SpriteFrame,front_texture:cc.SpriteFrame,butt:cc.Sprite,bubble:cc.Sprite,left_bamboo:cc.Sprite,middle_bamboo:cc.Sprite,right_bamboo:cc.Sprite,shield_time:5},start:function(){this.panda_status=i.PandaStatus.NORMAL,this.jumping=!1,this.current_bamboo_id=i.BambooType.MIDDLE_BAMBOO,this.side=i.SideType.LEFT_SIDE,this.direction=i.PandaDirection.IDLE;var e=this.node.getContentSize(),t=(this.middle_bamboo.node.getContentSize(),this.middle_bamboo.node.x-e.width/2),o=this.middle_bamboo.node.y;this.node.setPosition(t,o),this.node.zIndex=5,this.bubble.node.active=!1},revive:function(){this.node.active=!0,this.getComponent(cc.Animation).stop(),this.getComponent(cc.Sprite).spriteFrame=this.leftside_texture,this.node.scaleX=1,this.panda_status=i.PandaStatus.NORMAL,this.jumping=!1,this.current_bamboo_id=i.BambooType.MIDDLE_BAMBOO,this.side=i.SideType.LEFT_SIDE,this.direction=i.PandaDirection.IDLE;var e=this.node.getContentSize(),t=(this.middle_bamboo.node.getContentSize(),this.middle_bamboo.node.x-e.width/2),o=this.middle_bamboo.node.y;this.node.setPosition(t,o),this.node.zIndex=5,this.bubble.node.active=!1},idle:function(){this.direction=i.PandaDirection.IDLE,this.butt.node.active=!1;var e=this.getComponent(cc.Animation);e.getAnimationState("panda_move").isPlaying&&e.pause("panda_move")},moveUp:function(){this.direction=i.PandaDirection.UP,this.butt.node.active=!1;var e=this.getComponent(cc.Animation),t=e.getAnimationState("panda_move");t.isPlaying?t.isPaused&&e.resume("panda_move"):e.play("panda_move")},moveDown:function(){this.direction=i.PandaDirection.DOWN,this.butt.node.active=!0;var e=this.getComponent(cc.Animation),t=e.getAnimationState("panda_move");t.isPlaying?t.isPaused&&e.resume("panda_move"):e.play("panda_move")},jumpLeft:function(){if(this.direction===i.PandaDirection.IDLE&&!this.jumping){this.butt.node.active=!1,this.direction=i.PandaDirection.LEFT;var e=this.getComponent(cc.Animation);if(e.getAnimationState("panda_move").isPlaying&&e.pause("panda_move"),this.side===i.SideType.RIGHT_SIDE){var t=null;this.current_bamboo_id===i.BambooType.LEFT_BAMBOO?t=this.left_bamboo:this.current_bamboo_id===i.BambooType.MIDDLE_BAMBOO?t=this.middle_bamboo:this.current_bamboo_id===i.BambooType.RIGHT_BAMBOO?t=this.right_bamboo:cc.log("unkown current_bamboo_id"),cc.audioEngine.playEffect(this.jump_effect),this.jumping=!0;var o=t.node.x-this.node.getContentSize().width/2,n=cc.moveTo(this.flip_duration,cc.v2(o,this.node.y)),c=cc.callFunc(function(){this.node.scaleX=-this.node.scaleX,this.node.x=o,this.side=i.SideType.LEFT_SIDE,this.direction=i.PandaDirection.IDLE,this.jumping=!1},this),a=cc.sequence(n,c);this.node.runAction(a)}else if(this.side===i.SideType.LEFT_SIDE)if(this.current_bamboo_id>i.BambooType.LEFT_BAMBOO){this.current_bamboo_id-=1;var s=null;this.current_bamboo_id===i.BambooType.LEFT_BAMBOO?s=this.left_bamboo:this.current_bamboo_id===i.BambooType.MIDDLE_BAMBOO?s=this.middle_bamboo:this.current_bamboo_id===i.BambooType.RIGHT_BAMBOO?s=this.right_bamboo:cc.log("unkown current_bamboo_id"),this.node.scaleX=-this.node.scaleX,cc.audioEngine.playEffect(this.jump_effect),this.jumping=!0;var r=s.node.x+this.node.getContentSize().width/2,d=cc.moveBy(this.jump_duration,cc.v2(0,this.jump_height)).easing(cc.easeCubicActionOut()),h=cc.moveBy(this.jump_duration,cc.v2(0,-this.jump_height)).easing(cc.easeCubicActionIn()),l=cc.sequence(d,h),u=cc.moveTo(2*this.jump_duration,cc.v2(r,this.node.y)),_=cc.spawn(l,u),p=cc.callFunc(function(){this.node.x=r,this.side=i.SideType.RIGHT_SIDE,this.direction=i.PandaDirection.IDLE,this.jumping=!1},this),m=cc.sequence(_,p);this.node.runAction(m)}else this.direction=i.PandaDirection.IDLE}},jumpRight:function(){if(this.direction===i.PandaDirection.IDLE&&!this.jumping){this.butt.node.active=!1,this.direction=i.PandaDirection.RIGHT;var e=this.getComponent(cc.Animation);if(e.getAnimationState("panda_move").isPlaying&&e.pause("panda_move"),this.side===i.SideType.LEFT_SIDE){var t=null;this.current_bamboo_id===i.BambooType.LEFT_BAMBOO?t=this.left_bamboo:this.current_bamboo_id===i.BambooType.MIDDLE_BAMBOO?t=this.middle_bamboo:this.current_bamboo_id===i.BambooType.RIGHT_BAMBOO?t=this.right_bamboo:cc.log("unkown current_bamboo_id"),cc.audioEngine.playEffect(this.jump_effect),this.jumping=!0;var o=t.node.x+this.node.getContentSize().width/2,n=cc.moveTo(this.flip_duration,cc.v2(o,this.node.y)),c=cc.callFunc(function(){this.node.scaleX=-this.node.scaleX,this.node.x=o,this.side=i.SideType.RIGHT_SIDE,this.direction=i.PandaDirection.IDLE,this.jumping=!1},this),a=cc.sequence(n,c);this.node.runAction(a)}else if(this.side===i.SideType.RIGHT_SIDE)if(this.current_bamboo_id<i.BambooType.RIGHT_BAMBOO){this.current_bamboo_id+=1;var s=null;this.current_bamboo_id===i.BambooType.LEFT_BAMBOO?s=this.left_bamboo:this.current_bamboo_id===i.BambooType.MIDDLE_BAMBOO?s=this.middle_bamboo:this.current_bamboo_id===i.BambooType.RIGHT_BAMBOO?s=this.right_bamboo:cc.log("unkown current_bamboo_id"),this.node.scaleX=-this.node.scaleX,cc.audioEngine.playEffect(this.jump_effect),this.jumping=!0;var r=s.node.x-this.node.getContentSize().width/2,d=cc.moveBy(this.jump_duration,cc.v2(0,this.jump_height)).easing(cc.easeCubicActionOut()),h=cc.moveBy(this.jump_duration,cc.v2(0,-this.jump_height)).easing(cc.easeCubicActionIn()),l=cc.sequence(d,h),u=cc.moveTo(2*this.jump_duration,cc.v2(r,this.node.y)),_=cc.spawn(l,u),p=cc.callFunc(function(){this.node.x=r,this.side=i.SideType.LEFT_SIDE,this.direction=i.PandaDirection.IDLE,this.jumping=!1},this),m=cc.sequence(_,p);this.node.runAction(m)}else this.direction=i.PandaDirection.IDLE}},drop:function(){this.direction=i.PandaDirection.IDLE,this.getComponent(cc.Animation).play("panda_drop");var e=this.node.parent.getContentSize(),t=null;if(this.side===i.SideType.LEFT_SIDE){var o=this.node.x-this.drop_distance,n=-e.height/2-this.node.height/2;this.node.x=o;var c=(this.node.y+e.height/2)/e.height*this.drop_base_duration;t=cc.moveTo(c,cc.v2(o,n)).easing(cc.easeCubicActionIn())}else if(this.side===i.SideType.RIGHT_SIDE){var a=this.node.x+this.drop_distance,s=-e.height/2-this.node.height/2;this.node.x=a;var r=(this.node.y+e.height/2)/e.height*this.drop_base_duration;t=cc.moveTo(r,cc.v2(a,s)).easing(cc.easeCubicActionIn())}if(t){var d=cc.callFunc(function(){this.game_canvas.getComponent("game").showGameOverPanel(),this.node.active=!1},this),h=cc.sequence(t,d);this.scheduleOnce(function(){this.node.runAction(h)},1.2)}else cc.log("drop action is null")},fetchProp:function(e){var t=this;cc.log("panda fetch prop"),cc.audioEngine.playEffect(this.pick_effect),e===i.PropType.SHIELD?(cc.log("panda get shield"),this.panda_status=i.PandaStatus.GOD,this.bubble.node.active=!0,this.scheduleOnce(function(){cc.log("panda lose shield"),t.panda_status=i.PandaStatus.NORMAL,t.bubble.node.active=!1},this.shield_time)):e===i.PropType.SHAKE?(cc.log("panada get shake"),cc.audioEngine.playEffect(this.all_kill_effect),cc.sys.platform===cc.sys.WECHAT_GAME?wx.vibrateLong():cc.sys.platform===cc.sys.BYTEDANCE_GAME&&tt.vibrateLong({success:function(e){console.log("vibrate success")},fail:function(e){console.log("vibrate failed")}}),this.game_canvas.getComponent("game").shakeEffect(.5),this.game_canvas.getComponent("game").dropAllInsects()):e===i.PropType.LIFE&&(cc.log("panda get life"),this.game_canvas.getComponent("game").increaseLeaf())},update:function(e){var t=this.node.height,o=this.node.parent.height;this.direction==i.PandaDirection.UP?this.node.y<o/2-t/2&&(this.node.y+=this.move_speed*e):this.direction==i.PandaDirection.DOWN&&this.node.y>-(o/2-t/2)&&(this.node.y-=this.move_speed*e)}}),cc._RF.pop()},{}],prop:[function(e,t,o){"use strict";cc._RF.push(t,"3dbf3qkIaVN5LKIM09gVEaC","prop");var n=e;t.exports;n("common"),cc.Class({extends:cc.Component,properties:{twinkle_scale:.2,twinkle_duration:.5},setType:function(e){this.prop_type=e},start:function(){var e=cc.repeatForever(cc.sequence(cc.scaleTo(this.twinkle_duration,1+this.twinkle_scale),cc.scaleTo(this.twinkle_duration,1-this.twinkle_scale)));this.node.runAction(e)}}),cc._RF.pop()},{}],share:[function(e,t,o){"use strict";cc._RF.push(t,"9db50sh7YxHOL/qdIp0lYM3","share");var n=e,i=(t.exports,function(e){return e&&e.__esModule?e:{default:e}}(n("toast")));cc.Class({extends:cc.Component,properties:{share_image:cc.Texture2D},onLoad:function(){this.share_titles=["\u5feb\u6765\u73a9\u4e00\u73a9\u8fd9\u53ea\u840c\u840c\u7684\u718a\u732b\u5427","\u718a\u732b\u722c\u7af9\u5b50\u8e29\u74e2\u866b\u54e6","\u53ef\u7231\u7684\u5927\u718a\u732b\u7b49\u4f60\u6765\u73a9\u5440","\u8fd9\u91cc\u6709\u4e00\u53ea\u8c03\u76ae\u7684\u5927\u718a\u732b","\u60f3\u4e0d\u60f3\u9886\u517b\u7231\u5403\u7af9\u5b50\u7684\u718a\u732b\u5462"],this.shared_flag=!1,this.onPassiveShare(),this.onClickShared()},getShareParams:function(){var e=Math.floor(Math.random()*this.share_titles.length);return{title:this.share_titles[e],imageUrl:this.share_image.url,query:"shared_key=the page info"}},doActiveShare:function(){var e=this;cc.log("doActiveShare"),cc.sys.platform===cc.sys.WECHAT_GAME?(console.log("wechat game platform, doActiveShare"),this.shared_flag=!0,this.share_time=(new Date).getTime(),wx.shareAppMessage(this.getShareParams()),wx.onShow(function(){if(console.log("wechat game onShow"),e.shared_flag){var t=(new Date).getTime();t-e.share_time>2500?(console.log("share success"),(0,i.default)("\u5206\u4eab\u6210\u529f\uff0c\u8c22\u8c22\u60a8\u7684\u559c\u7231\uff01")):(console.log("share failed"),(0,i.default)("\u5206\u4eab\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u5c1d\u8bd5\u54e6\uff5e")),e.shared_flag=!1,e.share_time=t}})):(0,i.default)("\u5f53\u524d\u5e73\u53f0\u4e0d\u652f\u6301\u5206\u4eab")},onPassiveShare:function(){var e=this;console.log("onPassiveShare"),cc.sys.platform===cc.sys.WECHAT_GAME&&(console.log("wechat game platform, onPassiveShare"),wx.showShareMenu({success:function(e){cc.log("open wechat passive share menu success"),cc.log(e)},fail:function(e){cc.log("pen wechat passive share menu failed"),cc.log(e)}}),wx.onShareAppMessage(function(){return e.getShareParams()}))},onClickShared:function(){if(console.log("onClickShared"),cc.sys.platform===cc.sys.WECHAT_GAME){console.log("wechat game platform, onClickShared");var e=wx.getLaunchOptionsSync().shared_key;cc.log("shared value:",e)}},start:function(){}}),cc._RF.pop()},{}],toast:[function(e,t,o){"use strict";cc._RF.push(t,"a09cau03T5NS5byfZWSLrlz","toast");var n=t;t.exports;n.exports=function(e,t){void 0===e&&(e="");var o=void 0===t?{}:t,n=o.gravity,i=void 0===n?"CENTER":n,c=o.duration,a=void 0===c?1:c,s=o.bg_color,r=void 0===s?cc.color(102,102,102,200):s,d=cc.director.getScene().getComponentInChildren(cc.Canvas),h=d.node.width,l=d.node.height,u=new cc.Node,_=new cc.Node,p=_.addComponent(cc.Label);p.horizontalAlign=cc.Label.HorizontalAlign.CENTER,p.verticalAlign=cc.Label.VerticalAlign.CENTER,p.fontSize=30,p.string=e,e.length*p.fontSize>3*h/5?(_.width=3*h/5,p.overflow=cc.Label.Overflow.RESIZE_HEIGHT):_.width=e.length*p.fontSize;var m=1+~~(e.length*p.fontSize/(3*h/5));_.height=p.fontSize*m;var f=u.addComponent(cc.Graphics);f.arc(-_.width/2,0,_.height/2+20,.5*Math.PI,1.5*Math.PI,!0),f.lineTo(_.width/2,-(_.height/2+20)),f.arc(_.width/2,0,_.height/2+20,1.5*Math.PI,.5*Math.PI,!0),f.lineTo(-_.width/2,_.height/2+20),f.fillColor=r,f.fill(),u.addChild(_),"CENTER"===i?(u.y=0,u.x=0):"TOP"===i?u.y=u.y+l/5*2:"BOTTOM"===i&&(u.y=u.y-l/5*2),d.node.addChild(u);var g=cc.callFunc(function(){u.destroy()}),b=cc.sequence(cc.moveBy(a,cc.v2(0,0)),cc.fadeOut(.3),g);u.runAction(b)},cc._RF.pop()},{}],ts:[function(e,t,o){"use strict";cc._RF.push(t,"065945SrEVOtaVyUgtZDhD7","ts"),cc._RF.pop()},{}]},{},["common","game","global","insect","menu","panda","prop","share","toast","ts"]);